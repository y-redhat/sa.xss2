<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSS脆弱性デモ（安全版）</title>
</head>
<body>
    <h1>XSS脆弱性学習用デモ</h1>
    <p>このページは安全にXSSを学ぶためのデモです</p>

    <div style="border: 2px solid red; padding: 15px; margin: 15px 0;">
        <h2>脆弱な検索機能</h2>
        <input type="text" id="searchInput" placeholder="検索キーワードを入力">
        <button onclick="doSearch()">検索</button>
        <div id="result" style="margin-top: 10px;"></div>
    </div>

    <div style="border: 2px solid red; padding: 15px; margin: 15px 0;">
        <h2>脆弱なコメント欄</h2>
        <input type="text" id="commentInput" placeholder="コメントを入力">
        <button onclick="addComment()">コメント投稿</button>
        <div id="commentArea" style="margin-top: 10px;"></div>
    </div>

    <div style="background: #f0f0f0; padding: 15px; margin: 15px 0;">
        <h3>テスト用XSSコード例:</h3>
        <p><code>&lt;script&gt;alert('XSSテスト')&lt;/script&gt;</code></p>
        <p><code>&lt;img src=x onerror="alert('画像読み込みエラー')"&gt;</code></p>
        <p><code>通常のテキスト&lt;button onclick="alert('ボタン')"&gt;クリック&lt;/button&gt;</code></p>
    </div>

    <script>
        function doSearch() {
            const input = document.getElementById('searchInput').value;
            // ❌ 危険なコード: innerHTMLで直接表示
            document.getElementById('result').innerHTML = 
                "検索結果: " + input;
        }

        function addComment() {
            const comment = document.getElementById('commentInput').value;
            const div = document.createElement('div');
            // ❌ 危険なコード: innerHTMLで直接表示
            div.innerHTML = "コメント: " + comment;
            document.getElementById('commentArea').appendChild(div);
            document.getElementById('commentInput').value = '';
        }
    </script>

    <div style="background: #e6ffe6; padding: 15px; margin-top: 20px;">
        <h3>学習のポイント</h3>
        <ul>
            <li>ユーザー入力をinnerHTMLで直接表示するとXSSの危険がある</li>
            <li>代わりにtextContentを使うと安全</li>
            <li>常に入力値を検証・エスケープする</li>
        </ul>
    </div>
</body>
</html>
