<!DOCTYPE html>
<html>
<head>
    <title>XSS脆弱性デモ - 安全版</title>
</head>
<body>
    <h1>XSS脆弱性テスト（安全版）</h1>
    <p>ページを開いた瞬間にリダイレクトされないように修正しました</p>
    
    <!-- 脆弱な検索機能 -->
    <div>
        <h2>脆弱な検索</h2>
        <input type="text" id="searchInput" placeholder="検索キーワード">
        <button onclick="vulnerableSearch()">検索</button>
        <div id="searchResult"></div>
    </div>

    <!-- 脆弱なコメント機能 -->
    <div>
        <h2>脆弱なコメント欄</h2>
        <input type="text" id="commentInput" placeholder="コメントを入力">
        <button onclick="addComment()">コメント投稿</button>
        <div id="comments"></div>
    </div>

    <!-- 脆弱なプロフィール表示 -->
    <div>
        <h2>脆弱なプロフィール</h2>
        <input type="text" id="nameInput" placeholder="名前" value="ユーザー">
        <input type="text" id="bioInput" placeholder="自己紹介" value="こんにちは">
        <button onclick="showProfile()">プロフィール表示</button>
        <div id="profile"></div>
    </div>

    <script>
        // ❌ 危険: XSS脆弱性あり（ただし安全な範囲で）
        function vulnerableSearch() {
            const query = document.getElementById('searchInput').value;
            // 脆弱性: innerHTMLでそのまま表示
            document.getElementById('searchResult').innerHTML = 
                `検索結果: ${query}`;
        }

        // ❌ 危険: XSS脆弱性あり
        function addComment() {
            const comment = document.getElementById('commentInput').value;
            const commentDiv = document.createElement('div');
            // 脆弱性: innerHTMLでそのまま表示
            commentDiv.innerHTML = `コメント: ${comment}`;
            document.getElementById('comments').appendChild(commentDiv);
        }

        // ❌ 危険: XSS脆弱性あり
        function showProfile() {
            const name = document.getElementById('nameInput').value;
            const bio = document.getElementById('bioInput').value;
            // 脆弱性: innerHTMLでそのまま表示
            document.getElementById('profile').innerHTML = `
                <h3>${name}のプロフィール</h3>
                <p>${bio}</p>
            `;
        }
    </script>

    <div style="margin-top: 50px; background: #f0f0f0; padding: 10px;">
        <h3>テスト用XSSペイロード（安全なもの）:</h3>
        <ul>
            <li><code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code></li>
            <li><code>&lt;img src=x onerror="alert('Hacked')"&gt;</code></li>
            <li><code>&lt;button onclick="alert('Clicked')"&gt;クリック&lt;/button&gt;</code></li>
            <li><code>&lt;div style="background:red;color:white;"&gt;HACKED&lt;/div&gt;</code></li>
        </ul>
        
        <p style="color: red; font-weight: bold;">
            ⚠ 注意: ページをリダイレクトするコードは使用しないでください
        </p>
    </div>
</body>
</html>
