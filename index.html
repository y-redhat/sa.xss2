<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSSãƒ‡ãƒ¼ã‚¿æ”¹ã–ã‚“ãƒ‡ãƒ¢</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .vulnerable { border: 2px solid red; padding: 15px; margin: 15px 0; background: #ffe6e6; }
        .secure { border: 2px solid green; padding: 15px; margin: 15px 0; background: #e6ffe6; }
        .payload { background: #f0f0f0; padding: 10px; margin: 10px 0; font-family: monospace; }
        button { padding: 8px 15px; margin: 5px; cursor: pointer; }
        input, textarea { width: 100%; padding: 8px; margin: 5px 0; }
        .user-data { background: #e6f3ff; padding: 10px; margin: 10px 0; }
        .warning { color: red; font-weight: bold; }
        .success { color: green; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ğŸ”“ XSSãƒ‡ãƒ¼ã‚¿æ”¹ã–ã‚“ãƒ‡ãƒ¢</h1>
    <p class="warning">âš  ã“ã®ãƒšãƒ¼ã‚¸ã«ã¯æ„å›³çš„ã«XSSè„†å¼±æ€§ãŒã‚ã‚Šã¾ã™ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã®ã¿ï¼‰</p>

    <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
    <div class="user-data">
        <h3>ğŸ“Š ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿:</h3>
        <div id="userDisplay">
            ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“
        </div>
    </div>

    <!-- è„†å¼±ãªå…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  -->
    <div class="vulnerable">
        <h2>âŒ è„†å¼±ãªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç™»éŒ²</h2>
        <p>XSSè„†å¼±æ€§ã‚ã‚Š - ãƒ‡ãƒ¼ã‚¿æ”¹ã–ã‚“å¯èƒ½</p>
        
        <input type="text" id="vulnName" placeholder="ãƒ¦ãƒ¼ã‚¶ãƒ¼å" value="å±±ç”°å¤ªéƒ">
        <textarea id="vulnBio" placeholder="è‡ªå·±ç´¹ä»‹">é€šå¸¸ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã™</textarea>
        <button onclick="saveVulnerableProfile()">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä¿å­˜</button>
        
        <div class="payload">
            <strong>XSSãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ä¾‹:</strong><br>
            ãƒ¦ãƒ¼ã‚¶ãƒ¼å: <code>ãƒãƒƒã‚«ãƒ¼&lt;script&gt;stealData()&lt;/script&gt;</code><br>
            è‡ªå·±ç´¹ä»‹: <code>é€šå¸¸ã®ãƒ†ã‚­ã‚¹ãƒˆ&lt;script&gt;document.getElementById('userDisplay').innerHTML='HACKED!'&lt;/script&gt;</code>
        </div>
    </div>

    <!-- è„†å¼±ãªæ¤œç´¢æ©Ÿèƒ½ -->
    <div class="vulnerable">
        <h2>âŒ è„†å¼±ãªæ¤œç´¢æ©Ÿèƒ½</h2>
        <input type="text" id="vulnSearch" placeholder="æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰">
        <button onclick="vulnerableSearch()">æ¤œç´¢</button>
        
        <div id="searchResults" style="margin-top: 10px;"></div>
        
        <div class="payload">
            <strong>XSSãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ä¾‹:</strong><br>
            <code>&lt;img src=x onerror="alert('XSS')"&gt;</code><br>
            <code>&lt;script&gt;document.body.style.background='red'&lt;/script&gt;</code>
        </div>
    </div>

    <!-- è„†å¼±ãªã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½ -->
    <div class="vulnerable">
        <h2>âŒ è„†å¼±ãªã‚³ãƒ¡ãƒ³ãƒˆæ¬„</h2>
        <textarea id="vulnComment" placeholder="ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›..."></textarea>
        <button onclick="addVulnerableComment()">ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿</button>
        
        <div id="comments" style="margin-top: 10px;"></div>
        
        <div class="payload">
            <strong>XSSãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ä¾‹:</strong><br>
            <code>ã“ã‚“ã«ã¡ã¯ï¼&lt;script&gt;showFakeLogin()&lt;/script&gt;</code><br>
            <code>&lt;button onclick="deleteAllData()"&gt;ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆç²å¾—&lt;/button&gt;</code>
        </div>
    </div>

    <!-- å®‰å…¨ãªå…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆæ¯”è¼ƒç”¨ï¼‰ -->
    <div class="secure">
        <h2>âœ… å®‰å…¨ãªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç™»éŒ²</h2>
        <p>XSSå¯¾ç­–æ¸ˆã¿</p>
        
        <input type="text" id="secureName" placeholder="ãƒ¦ãƒ¼ã‚¶ãƒ¼å" value="å±±ç”°å¤ªéƒ">
        <textarea id="secureBio" placeholder="è‡ªå·±ç´¹ä»‹">é€šå¸¸ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã™</textarea>
        <button onclick="saveSecureProfile()">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä¿å­˜</button>
    </div>

    <!-- ãƒ‡ãƒ¼ã‚¿æ“ä½œãƒ‡ãƒ¢ -->
    <div class="vulnerable">
        <h2>ğŸ¯ XSSãƒ‡ãƒ¼ã‚¿æ”¹ã–ã‚“ãƒ‡ãƒ¢</h2>
        <p>ä»¥ä¸‹ã®ãƒœã‚¿ãƒ³ã§XSSæ”»æ’ƒã®åŠ¹æœã‚’ç¢ºèªã§ãã¾ã™</p>
        
        <button onclick="demoSimpleXSS()">ã‚·ãƒ³ãƒ—ãƒ«ãªXSSå®Ÿè¡Œ</button>
        <button onclick="demoDataSteal()">ãƒ‡ãƒ¼ã‚¿çªƒå–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</button>
        <button onclick="demoPageTakeover()">ãƒšãƒ¼ã‚¸ä¹—ã£å–ã‚Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</button>
        <button onclick="demoFakeLogin()">å½ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤º</button>
        <button onclick="resetPage()">ãƒšãƒ¼ã‚¸ãƒªã‚»ãƒƒãƒˆ</button>
    </div>

    <script>
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿
        let userData = {
            name: "å±±ç”°å¤ªéƒ",
            bio: "é€šå¸¸ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã™",
            balance: 10000,
            isAdmin: false
        };

        // è„†å¼±ãªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä¿å­˜
        function saveVulnerableProfile() {
            const name = document.getElementById('vulnName').value;
            const bio = document.getElementById('vulnBio').value;
            
            // âŒ å±é™º: innerHTMLã§ãã®ã¾ã¾è¡¨ç¤º
            document.getElementById('userDisplay').innerHTML = `
                <strong>åå‰:</strong> ${name}<br>
                <strong>è‡ªå·±ç´¹ä»‹:</strong> ${bio}<br>
                <strong>æ®‹é«˜:</strong> Â¥${userData.balance.toLocaleString()}<br>
                <strong>ç®¡ç†è€…:</strong> ${userData.isAdmin ? 'ã¯ã„' : 'ã„ã„ãˆ'}
            `;
            
            userData.name = name;
            userData.bio = bio;
        }

        // è„†å¼±ãªæ¤œç´¢
        function vulnerableSearch() {
            const query = document.getElementById('vulnSearch').value;
            
            // âŒ å±é™º: ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’ãã®ã¾ã¾HTMLã«æŒ¿å…¥
            document.getElementById('searchResults').innerHTML = `
                <h4>ã€Œ${query}ã€ã®æ¤œç´¢çµæœ:</h4>
                <p>çµæœãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ: ${query}</p>
            `;
        }

        // è„†å¼±ãªã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ 
        function addVulnerableComment() {
            const comment = document.getElementById('vulnComment').value;
            
            // âŒ å±é™º: å‹•çš„ã«HTMLã‚’æ§‹ç¯‰
            const commentDiv = document.createElement('div');
            commentDiv.className = 'comment';
            commentDiv.innerHTML = `
                <strong>åŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼:</strong>
                <span>${comment}</span>
                <small>${new Date().toLocaleString()}</small>
                <hr>
            `;
            
            document.getElementById('comments').appendChild(commentDiv);
            document.getElementById('vulnComment').value = '';
        }

        // å®‰å…¨ãªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä¿å­˜
        function saveSecureProfile() {
            const name = document.getElementById('secureName').value;
            const bio = document.getElementById('secureBio').value;
            
            // âœ… å®‰å…¨: textContentã‚’ä½¿ç”¨
            const display = document.getElementById('userDisplay');
            display.innerHTML = ''; // ä¸€æ—¦ã‚¯ãƒªã‚¢
            
            const nameElem = document.createElement('strong');
            nameElem.textContent = 'åå‰: ';
            display.appendChild(nameElem);
            display.appendChild(document.createTextNode(name));
            display.appendChild(document.createElement('br'));
            
            const bioElem = document.createElement('strong');
            bioElem.textContent = 'è‡ªå·±ç´¹ä»‹: ';
            display.appendChild(bioElem);
            display.appendChild(document.createTextNode(bio));
            display.appendChild(document.createElement('br'));
            
            const balanceElem = document.createElement('strong');
            balanceElem.textContent = 'æ®‹é«˜: ';
            display.appendChild(balanceElem);
            display.appendChild(document.createTextNode('Â¥' + userData.balance.toLocaleString()));
            display.appendChild(document.createElement('br'));
            
            const adminElem = document.createElement('strong');
            adminElem.textContent = 'ç®¡ç†è€…: ';
            display.appendChild(adminElem);
            display.appendChild(document.createTextNode(userData.isAdmin ? 'ã¯ã„' : 'ã„ã„ãˆ'));
            
            userData.name = name;
            userData.bio = bio;
        }

        // ãƒ‡ãƒ¢é–¢æ•°
        function demoSimpleXSS() {
            document.getElementById('vulnName').value = "ãƒãƒƒã‚«ãƒ¼<script>alert('XSSæˆåŠŸ!')</script>";
            document.getElementById('vulnBio').value = "é€šå¸¸ã®ãƒ†ã‚­ã‚¹ãƒˆ";
            saveVulnerableProfile();
            setTimeout(() => {
                alert('XSSãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸï¼');
            }, 100);
        }

        function demoDataSteal() {
            document.getElementById('vulnComment').value = "ã“ã‚“ã«ã¡ã¯ï¼<script>alert('ã‚ãªãŸã®æ®‹é«˜: Â¥' + userData.balance.toLocaleString())</script>";
            addVulnerableComment();
        }

        function demoPageTakeover() {
            document.getElementById('vulnSearch').value = "<script>document.body.innerHTML='<h1>ğŸ”“ ã“ã®ã‚µã‚¤ãƒˆã¯ãƒãƒƒã‚­ãƒ³ã‚°ã•ã‚Œã¾ã—ãŸ</h1><p>ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒç›—ã¾ã‚Œã¾ã—ãŸ</p><button onclick=\"location.reload()\">å…ƒã«æˆ»ã™</button>'</script>";
            vulnerableSearch();
        }

        function demoFakeLogin() {
            document.getElementById('vulnComment').value = "é‡è¦ãªãŠçŸ¥ã‚‰ã›:<script>showFakeLogin()</script>";
            addVulnerableComment();
        }

        // å½ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤ºé–¢æ•°
        function showFakeLogin() {
            const fakeLogin = document.createElement('div');
            fakeLogin.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            `;
            
            fakeLogin.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 10px; text-align: center;">
                    <h2 style="color: red;">âš  ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è­¦å‘Š</h2>
                    <p>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ç•°å¸¸ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ</p>
                    <p>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å†å…¥åŠ›ã—ã¦ãã ã•ã„:</p>
                    <input type="password" id="fakePassword" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" style="margin: 10px; padding: 8px;">
                    <br>
                    <button onclick="fakeLoginSubmit()" style="background: red; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">
                        ç¢ºèª
                    </button>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: gray; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
                        ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                    </button>
                </div>
            `;
            
            document.body.appendChild(fakeLogin);
        }

        function fakeLoginSubmit() {
            const password = document.getElementById('fakePassword').value;
            alert(`âš  å½ã®ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã§ã™ï¼\nå…¥åŠ›ã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: "${password}"\nå®Ÿéš›ã«ã¯é€ä¿¡ã•ã‚Œã¦ã„ã¾ã›ã‚“ãŒã€æœ¬ç‰©ã®æ”»æ’ƒã§ã¯ã“ã®æƒ…å ±ãŒç›—ã¾ã‚Œã¾ã™ã€‚`);
            document.querySelector('div[style*="position: fixed"]').remove();
        }

        function deleteAllData() {
            userData.balance = 0;
            userData.isAdmin = false;
            alert('ãƒ‡ãƒ¼ã‚¿ãŒæ”¹ã–ã‚“ã•ã‚Œã¾ã—ãŸï¼æ®‹é«˜ãŒ0å††ã«ãªã‚Šã¾ã—ãŸã€‚');
            saveVulnerableProfile();
        }

        function stealData() {
            const stolenData = `ç›—ã¾ã‚ŒãŸãƒ‡ãƒ¼ã‚¿: åå‰=${userData.name}, æ®‹é«˜=${userData.balance}`;
            alert('ãƒ‡ãƒ¼ã‚¿çªƒå–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: ' + stolenData);
        }

        function resetPage() {
            location.reload();
        }

        // åˆæœŸãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
        saveSecureProfile();
    </script>

    <div style="margin-top: 30px; padding: 15px; background: #fff3cd; border: 1px solid #ffeaa7;">
        <h3>ğŸ“š å­¦ç¿’ã®ãƒã‚¤ãƒ³ãƒˆ</h3>
        <ul>
            <li><strong>XSSã®å±é™ºæ€§:</strong> ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ãŒãã®ã¾ã¾JavaScriptã¨ã—ã¦å®Ÿè¡Œã•ã‚Œã‚‹</li>
            <li><strong>ãƒ‡ãƒ¼ã‚¿æ”¹ã–ã‚“:</strong> æ®‹é«˜ã‚„æ¨©é™ãªã©ã®ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´å¯èƒ½</li>
            <li><strong>ãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°:</strong> å½ã®ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã§æƒ…å ±ã‚’ç›—ã‚€</li>
            <li><strong>é˜²å¾¡æ–¹æ³•:</strong> textContentã‚’ä½¿ã†ã€å…¥åŠ›ã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã™ã‚‹</li>
        </ul>
        <p class="warning">âš  ã“ã®ãƒšãƒ¼ã‚¸ã®å†…å®¹ã¯ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®ã¿å®Ÿè¡Œã—ã¦ãã ã•ã„</p>
    </div>
</body>
</html>
